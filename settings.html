<!DOCTYPE html> 
<html>
<head>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1"> 
	<title>FoodLog</title> 
	<!--<link rel="stylesheet" href="http://code.jquery.com/mobile/1.2.1/jquery.mobile-1.2.1.min.css" />
	<script src="http://code.jquery.com/jquery-1.8.3.min.js"></script>
	<script src="http://code.jquery.com/mobile/1.2.1/jquery.mobile-1.2.1.min.js"></script>-->
	<!--<link href="http://code.jquery.com/mobile/latest/jquery.mobile.css" rel="stylesheet" type="text/css" />-->
	 <link rel="stylesheet" type="text/css" href="jquery.mobile.flatui.css" />
	<link rel="stylesheet" type="text/css" href="food.css" />
	 <script src="http://ajax.googleapis.com/ajax/libs/jquery/2.0.0/jquery.min.js"></script>
	<script src="http://code.jquery.com/mobile/latest/jquery.mobile.js">
	</script>
	<script src="Chart.js"/>
	</script>


	<script type="text/javascript">
	$(document).ready(function() {
		loadFromLocalStorage();
  		$('#age').change(function() {
		  updateKcal();
		});
		$('#gender').change(function() {
		  updateKcal();
		});
		$('#height').change(function() {
		  updateKcal();
		});
		$('#weight').change(function() {
		  updateKcal();
		});

		$( "#btn_cancel" )
	      .button()
	      .click(function( event ) {
	        parent.history.back();
        	return false;
	      });
	      $( "#btn_save" )
	      .button()
	      .click(function( event ) {
	        event.preventDefault();
			//$('#settings_form').submit();
			
	        localStorage.age=$('#age').val();
	        localStorage.height=$('#height').val();
	        localStorage.weight=$('#weight').val();
	        localStorage.gender=$('#gender').val();
	        localStorage.daily_limit=$('#daily_limit').val();
	        localStorage.meal_limit=$('#meal_limit').val();


	      });
	});
	loadFromLocalStorage=function(){
		restore('age');
		restore("height");
		restore("weight");
		restore("daily_limit");
		restore("meal_limit");
		if (localStorage.getItem("gender") != null) {
  			
			var optionValue=localStorage.gender;
			$("#gender").val(optionValue);
		}
		

	}
	restore=function(name){
		if (localStorage.getItem(name) != null) {
  			$('#'+name).val(parseInt(localStorage.getItem(name)));
		}
	}
	updateKcal=function(){
        var weight=$('#weight').val();
        var height=$('#height').val();
        var age=$('#age').val();
        var kcal=0;
        if($('#gender').val()=="male"){
  			
  			kcal = 10 * weight + 6.25 * height - 5 * age + 5;
        }
        else if($('#gender').val()=="female"){
        	
        	kcal = 10 * weight + 6.25 * height - 5 * age - 161;
        }
        kcal=new Number(kcal)
        $('#daily_limit').val(Math.round(kcal));
      
	}
	</script>
</head> 

	
<body> 

<!-- Start of first page: #one -->
<div data-role="page" id="main">

	<div data-role="header">
		<h1>Settings</h1>
	</div>

	<div data-role="content" >	
		 <div class="ui-grid-a">
			 <form id="settings_form">
            <div class="ui-block-a">
            	<p>Gender</p>
            </div>
            <div class="ui-block-b">
            <select name="gender" id="gender">
			   <option value="male">male</option>
			   <option value="female">female</option>
			</select>
            </div>
             <div class="ui-block-a">
            	<p>Age</p>
            </div>
            <div class="ui-block-b">
            	 <input  id="age" type="number" name="quantity" min="1" max="120" value="25">
            </div>
            <div class="ui-block-a">
            	<p>Height</p>
            </div>
            <div class="ui-block-b">
            	 <input id="height" type="number" name="quantity" min="50" max="220" value="175">
            </div>
            <div class="ui-block-a">
            	<p>Weight</p>
            </div>
            <div class="ui-block-b">
            	 <input id="weight" type="number" name="quantity" min="20" max="220" value="75">
            </div>
            <div class="ui-block-a">
            	<p>Daily kCal limit</p>
            </div>
            <div class="ui-block-b">
            	 <input id="daily_limit" type="number" name="quantity" min="1000" max="5000" value="2500">
            </div>
            <div class="ui-block-a">
            	<p>Meal kCal limit</p>
            </div>
            <div class="ui-block-b">
            	 <input id="meal_limit" type="number" name="quantity" min="20" max="1500" value="500">
            </div>
			</form>
            <div class="ui-block-a">
            	<a href="#" data-role="button" data-theme="d" id="btn_cancel">Cancel</a>
            </div>
            <div class="ui-block-b">
            	<a href="#" data-role="button" data-theme="g" id="btn_save">Save</a>
            </div>



            
        </div>
	</div><!-- /content -->
</div><!-- /page one -->



</body>
</html>